<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
        <link rel="icon" type="image/x-icon" href="/images/logo.png">
        <link rel="stylesheet" href="Style.css">
        <script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="jxdu6pl9vugjt2d"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.6.0/jszip.min.js"></script>
        <script src="../Config.js"></script> 
        <script src="Script.js"></script> 
        <title>Weekend Vaerelser Skanderup</title>
    </head>
    <body id="mainBody">
        <div id="top-bar">
            <div id="top-row">
                <img id="image-icon" src="images/logo.png">
                <div id="top-row-text-container">
                    <p id="top-row-text-top" class="top-row-text">Skanderup Efterskole</p>
                    <p id="top-row-text-bottom" class="top-row-text">Weekend</p>
                </div>
            </div>
            <nav id="bottom-row">
                <button class="nav-button" onclick="selectGroup('A')">A</button>
                <button class="nav-button" onclick="selectGroup('B')">B</button>
                <button class="nav-button" onclick="selectGroup('C')">C</button>
                <button class="nav-button" onclick="selectGroup('D')">D</button>
                <button class="nav-button" onclick="selectGroup('E')">E</button>
                <button class="nav-button" onclick="selectGroup('F')">F</button>
                <button class="nav-button" onclick="selectGroup('G')">G</button>
                <button class="nav-button" onclick="selectGroup('H')">H</button>
                <button class="nav-button" onclick="selectGroup('I')">I</button>
                <button class="nav-button" onclick="selectGroup('J')">J</button>
                <button class="nav-button" onclick="selectGroup('K')">K</button>
                <button class="nav-button" onclick="selectGroup('L')">L</button>
                <button class="nav-button" onclick="selectGroup('M')">M</button>
                <button class="nav-button" onclick="selectGroup('N')">N</button>
                <button class="nav-button" onclick="selectGroup('O')">O</button>
                <button class="nav-button" onclick="selectGroup('P')">P</button>
                <button class="nav-button" onclick="selectGroup('Q')">Q</button>
                <button class="nav-button" onclick="selectGroup('R')">R</button>
                <button class="nav-button" onclick="selectGroup('S')">S</button>
                <button class="nav-button" onclick="selectGroup('T')">T</button>
                <button class="nav-button" onclick="selectGroup('U')">U</button>
                <button class="nav-button" onclick="selectGroup('V')">V</button>
                <button class="nav-button" onclick="selectGroup('X')">X</button>
                <button class="nav-button" onclick="selectGroup('Y')">Y</button>
                <button class="nav-button" onclick="selectGroup('Z')">Z</button>
                <button class="nav-button" onclick="selectGroup('Alle')">Alle</button>
            </nav>
        </div>
        
        <div id="bottom-navigation">
            <div id="help-button" class="nav-button-icon" onclick="helpMenu()">
                ?
            </div>
            <div id="print-button" class="nav-button-icon" onclick="readyToPrint()">
                <svg id="printer-icon" width="16" height="16" fill="currentColor"  viewBox="0 0 16 16">
                    <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"/>
                    <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"/>
                </svg>
            </div>
            <div id="close-button" class="nav-button-icon DONT-SHOW" onclick="closeButton()">
                x
            </div>
        </div>
        <div id="file-input">
            <button id="file-select-button" onclick="callDropboxChooser()">Vælg Weekend</button>
        </div>
        <div id="print-popup">
            <div class="rows6 table" id="generated-table-1"></div>
            <div class="table" id="generated-table-2"></div>
            <div class="table" id="generated-table-3"></div>
            <div class="rows3 table" id="generated-table-4"></div>
        </div>
        <div id="help-menu">
            <div id="help-menu-title">
                Hjælp og vejledninger
            </div>
            <div id="help-menu-container">
                <div id="help-menu-content">
                    <div class="help-menu-element">
                        <p class="help-menu-element-title help-menu-text">
                            Sådan printer du
                        </p>
                        <div class="expandable-content" id="expandable-0">
                            <ul class="help-menu-element-content">
                                <li class="help-menu-text">
                                    Hvis du vil printe værelse-listen skal du enten trykke på print iconet
                                </li>
                                <li class="help-menu-text">
                                    Når du trykker på print åbner der et print-vindue, herinde skal du huske at sætte orientering som "Landskab". Du kan også eventuelt slå "Print sidehover og sidefødder" fra og slå "Udskriv baggrunde" til, men det er ikke nødvendigt.
                                </li>
                                <li class="help-menu-text">
                                    Efter du har printet vil du være inde på listen over hvor eleverne sover. Denne side kan lukkes ved at trykke (x) knappen nede i hjørnet. Dette retunere dig tilbage til siden hvor du kan vælge værelser.
                                </li>
                            </ul>
                        </div>
                        <div class="content-expand-button" id="expand-button-0" onclick="expandContent('expandable-0')">
                            Mere
                        </div>
                    </div>
                    <div class="help-menu-element">
                        <p class="help-menu-element-title help-menu-text">
                            Der sker ikke noget når jeg vælger weekend filen
                        </p>
                        <div class="expandable-content" id="expandable-1">
                            <p class="help-menu-element-content help-menu-text">
                                Der kan være flere grunde til at der ikke sker noget:
                            </p>
                            <ul class="help-menu-element-content">
                                <li class="help-menu-text">
                                    Det kan være at filen bare tager lidt lang til at loade, det bør dog ikke tage mere en et par minutter.
                                </li>
                                <li class="help-menu-text">
                                    Der kan være sket en uforudset fejl, prøv at genindlæs siden.
                                </li>
                                <li class="help-menu-text">
                                    Weekend filen kan være expoteret forkert fra viggo, og kan derfor ikke læses.
                                </li>   
                                <li class="help-menu-text">
                                    Prøv evt. en anden weekend fil for at se om den virker.
                                </li>
                            </ul>
                            <p class="help-menu-element-content help-menu-text help-menu-text-footer">
                                Hjemmeside konsolen kan også give indblik i hvad der er gået galt.
                            </p>
                        </div>
                        <div class="content-expand-button" id="expand-button-1" onclick="expandContent('expandable-1')">
                            Mere
                        </div>
                    </div>
                    <div class="help-menu-element">
                        <p class="help-menu-element-title help-menu-text">
                            Weekend filen virker ikke
                        </p>
                        <div class="expandable-content" id="expandable-2">
                            <p class="help-menu-element-content help-menu-text">
                                Der kan være flere grunde til at weekend filen ikke virkker:
                            </p>
                            <ul class="help-menu-element-content">
                                <li class="help-menu-text">
                                    Hvis filen ikke kan vælges skyles det at det ikke er en .csv fil. Hvis det er tilfælet skal der enten laves en ny fil som skal ligges op på Dropbox.
                                </li>
                                <li class="help-menu-text">
                                    Der kan være sket en uforudset fejl, prøv at genindlæs siden.
                                </li>
                                <li class="help-menu-text">
                                    Weekend filen kan være expoteret forkert fra viggo, og kan derfor ikke læses.
                                </li>   
                                <li class="help-menu-text">
                                    Din access-token fra Dropbox er udløbet, prøv at gå ind på hjemmesiden igen (ikke genindlæs).
                                </li>
                            </ul>
                            <p class="help-menu-element-content help-menu-text help-menu-text-footer">
                                Hjemmeside konsolen kan også give indblik i hvad der er gået galt.
                            </p>
                        </div>
                        <div class="content-expand-button" id="expand-button-2" onclick="expandContent('expandable-2')">
                            Mere
                        </div>
                    </div>
                    <div class="help-menu-element">
                        <p class="help-menu-element-title help-menu-text">
                            Sådan laver du en weekend fil
                        </p>
                        <div class="expandable-content" id="expandable-3">
                            <p class="help-menu-element-content help-menu-text">
                                Først skal du gå ind på Viggo.
                            </p>
                            <ul class="help-menu-element-content">
                                <li class="help-menu-text">
                                    På Viggo startsiden skal du klikke på: <span class="bold">Funktioner</span> > <span class="bold">Udskriv og eksport</span>.
                                </li>
                                <li class="help-menu-text">
                                    Derefter skal du huske at vælge <span class="bold">Ekspoter</span> og så <span class="bold">Gruppe</span>.
                                </li>
                                <li class="help-menu-text">
                                    I søgefeltet skal du søge efter den pågældende weekend.
                                </li>   
                                <li class="help-menu-text">
                                    Det eneste der skal være kryds ved er <span class="bold">Fornavn</span> og <span class="bold">Efternavn</span>, tryk derefter på <span class="bold">Ekspoter grupper</span>.
                                </li>
                            </ul>
                            <p class="help-menu-element-content help-menu-text">
                                Nu skal du åbne den fil du har downloadet i Excel.
                            </p>
                            <ul class="help-menu-element-content">
                                <li class="help-menu-text">
                                    I Excel skal du trykke på: <span class="bold">Fil</span> oppe i venstre hjørne.
                                </li>
                                <li class="help-menu-text">
                                    Derefter skal du trykke på: <span class="bold">Gem Som</span> og vælge et sted at gemme filen.
                                </li>
                                <li class="help-menu-text">
                                    Filen skal også have et navn så den er nem at finde, anbefalet format er: <span class="bold">"[weekend-nummer]. weekend d. [weekend-dato] [månede]"</span>.
                                </li>   
                                <li class="help-menu-text">
                                    Filen skal gemmes som fil formatet: <span class="bold">CSV UTF-8 (Comma delimited) (*.csv)</span>.
                                </li>
                            </ul>
                            <p class="help-menu-element-content help-menu-text">
                                Det sidste der skal gøres er at ligge filen i Dropbox mappen: <span class="bold">weekend-filer</span>.
                            </p>
                            <p class="help-menu-element-content help-menu-text help-menu-text-footer">
                                Mappens placering er: Apps > weekend api > Weekend Program > weekend-filer.
                            </p>
                        </div>
                        <div class="content-expand-button" id="expand-button-3" onclick="expandContent('expandable-3')">
                            Mere
                        </div>
                    </div>
                    <div class="help-menu-element last-element">
                        <p class="help-menu-element-title help-menu-text">
                            Sådan opdaterer du profilerne
                        </p>
                        <div class="expandable-content" id="expandable-4">
                            <p class="help-menu-element-content help-menu-text">
                                Først skal du gå ind på Viggo. <span class="help-menu-text-footer">(Dette trin skal gøres af en lærer)</span>
                            </p>
                            <ul class="help-menu-element-content">
                                <li class="help-menu-text">
                                    På Viggo startsiden skal du klikke på: <span class="bold">Funktioner</span> > <span class="bold">Udskriv og eksport</span>.
                                </li>
                                <li class="help-menu-text">
                                    Derefter skal du huske at vælge <span class="bold">Ekspoter</span> og så <span class="bold">Gruppe</span>.
                                </li>
                                <li class="help-menu-text">
                                    I søgefeltet skal du søge efter <span class="bold">Alle elever</span>.
                                </li>   
                                <li class="help-menu-text">
                                    Der skal være kryds ved: <span class="bold">Køn</span>, <span class="bold">Fornavn</span>, <span class="bold">Efternavn</span>, <span class="bold">Værelse</span> og <span class="bold">Elevnummer</span>
                                </li>
                            </ul>
                            <p class="help-menu-element-content help-menu-text">
                                Nu skal du åbne, både den fil du har downloadet og åbne den fil der hedder "Data-converter-v2", i Excel.
                            </p>
                            <ul class="help-menu-element-content">
                                <li class="help-menu-text">
                                    I den downloaded Excel fil skal du kopiere cellerne der har noget i sig.
                                </li>
                                <li class="help-menu-text">
                                    Derefter skal du gå ind på "Data-converter-v2" filen og paste det du har kopieret inde i den fane der hedder "DATA".
                                </li>
                                <li class="help-menu-text">
                                    Inde på "OUTPUT" fanen bør der nu være en masse navne, tekst og andet. Kopier alt fra <span class="bold">A1</span> til <span class="bold">F137</span> alt efter hvor mange elever der er. <span class="help-menu-text-footer">(Du skal ikke kopier navne der bare hedder "0", dette er bare ekstra pladser.)</span>
                                </li>   
                            </ul>
                            <p class="help-menu-element-content help-menu-text">
                                Når du har kopieret alt inde fra Excel skal du gå ind på <a class="link-text" href="https://shancarter.github.io/mr-data-converter/" target="_blank">denne her</a> hjemmeside.
                            </p>
                            <ul class="help-menu-element-content">
                                <li class="help-menu-text">
                                    I det øverste felt skal du paste alt det du har kopieret fra Excel filen.
                                </li>
                                <li class="help-menu-text">
                                    I feltet neden under skal du bare kopiere alt.
                                </li>
                            </ul>
                            <p class="help-menu-element-content help-menu-text">
                                Nu skal du åbne et nyt tekst dokument på din computer. <span class="help-menu-text-footer">(Det SKAL være et windows text dokument)</span>
                            </p>
                            <ul class="help-menu-element-content">
                                <li class="help-menu-text">
                                    Først skal du åbne dine filer.
                                </li>
                                <li class="help-menu-text">
                                    Derefter skal du vægle et sted at lave filen, du skal bare kunne finde den. 
                                </li>
                                <li class="help-menu-text">
                                    I venstre øverste hjørne skal du klikke på  <span class="bold">"Ny"</span> > <span class="bold">Tekst dokument</span>.
                                </li>
                                <li class="help-menu-text">
                                    Tekst dokumentet skal hedde <span class="bold">"Data"</span>. <span class="help-menu-text-footer">(Vigtigt at navnet starter med et stort "D".)</span>
                                </li>
                                <li class="help-menu-text">
                                    Inde i tekst dokument skal du paste det du kopierede inde fra hjemmesiden.
                                </li>
                            </ul>
                            <p class="help-menu-element-content help-menu-text">
                                Det sidste der skal gøres er at ligge filen i Dropbox mappen: <span class="bold">config</span>.
                            </p>
                            <p class="help-menu-element-content help-menu-text help-menu-text-footer">
                                Mappens placering er: Apps > weekend api > Weekend Program > config.
                            </p>
                        </div>
                        <div class="content-expand-button" id="expand-button-4" onclick="expandContent('expandable-4')">
                            Mere
                        </div>
                    </div>
                </div>
                <div id="credits">
                    <a class="credits-text" href="mailto:lucas.steele.sorensen@gmail.com">© Lucas Steele Sørensen 2024</a>
                    <p class="credits-text">Skanderup Efterskole Årgang 23/24</p>
                </div>
            </div>
        </div>
        <div id="alert-container" class="alert-container">
            <div id="top-alert" class="top-alert">
                  <span class="overlay"></span>
            </div>
            <div id="alert-content" class="alert-bg">
                <p id="alertText">Vælg venlist weekend filen</p>
            </div>
        </div>
        <div id="popup">
            <div class="popup-container">
                <div class="popup-top-container">
                    <p class="top-text">Vælg Soveplads</p>
                    <svg class="x-icon" width="23" height="23" viewBox="0 0 23 23" fill="none" onclick="closePopup()">
                        <path d="M11.5 0L11.5 23" fill="none" stroke="var(--text)" stroke-width="2"></path>
                        <path d="M23 11.5L-2.38419e-07 11.5" fill="none" stroke="var(--text)" stroke-width="2"></path>
                    </svg>
                </div>
                <div class="popup-inner-container">
                    <div id="header" style="display: none;">
                        <svg id="return-arrow" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="var(--text2)" fill="none" stroke-linecap="round" stroke-linejoin="round" onclick="returnBack()">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M9 13l-4 -4l4 -4m-4 4h11a4 4 0 0 1 0 8h-1"/>
                        </svg>
                        <p id="replaceableTextHeader">texttext</p>
                    </div>
                    <img id="replaceableImage" class="image" src="images/Dummy.svg" style="margin-top: 15px;">
                    <p id="replaceableText" class="alt-name-text">Navn Navnsen</p>
                    <div id="buttons-stage-1" class="popup-buttons">
                        <div>
                            <button class="popup-button" onclick="selectorButton('Eget')">På eget værelse</button>
                        </div>
                        <div>
                            <button class="popup-button" onclick="selectorButton('Andet')">På andet værelse</button>
                        </div>
                    </div>
                    <div id="buttons-stage-2" class="popup-buttons">
                        <div>
                            <button class="popup-button" onclick="selectHouse('Valhal')">Valhal</button>
                        </div>
                        <div>
                            <button class="popup-button" onclick="selectHouse('Udgård')">Udgård</button>
                        </div>
                        <div>
                            <button class="popup-button" onclick="selectHouse('Asgård')">Asgård</button>
                        </div>
                        <div>
                            <button class="popup-button" onclick="selectHouse('Midgård')">Midgård</button>
                        </div>
                    </div>
                    <div id="buttons-stage-3" class="popup-buttons">
                        <div>
                            <button id="btn-0" class="popup-button alt" onclick="selectRoom(0)">x</button>
                        </div>
                        <div>
                            <button id="btn-1" class="popup-button alt" onclick="selectRoom(1)">x</button>
                        </div>
                        <div>
                            <button id="btn-2" class="popup-button alt" onclick="selectRoom(2)">x</button>
                        </div>
                        <div>
                            <button id="btn-3" class="popup-button alt" onclick="selectRoom(3)">x</button>
                        </div>
                        <div>
                            <button id="btn-4" class="popup-button alt" onclick="selectRoom(4)">x</button>
                        </div>
                        <div>
                            <button id="btn-5" class="popup-button alt" onclick="selectRoom(5)">x</button>
                        </div>
                        <div>
                            <button id="btn-6" class="popup-button alt extra-btn" onclick="selectRoom(6)">x</button>
                        </div>
                        <div>
                            <button id="btn-7" class="popup-button alt extra-btn" onclick="selectRoom(7)">x</button>
                        </div>
                        <div>
                            <button id="btn-8" class="popup-button alt extra-btn" onclick="selectRoom(8)">x</button>
                        </div>
                        <div>
                            <button id="btn-9" class="popup-button alt extra-btn" onclick="selectRoom(9)">x</button>
                        </div>
                        <div>
                            <button id="btn-10" class="popup-button alt extra-btn" onclick="selectRoom(10)">x</button>
                        </div>
                        <div>
                            <button id="btn-11" class="popup-button alt extra-btn" onclick="selectRoom(11)">x</button>
                        </div>
                        <div>
                            <button id="btn-12" class="popup-button alt extra-btn" onclick="selectRoom(12)">x</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <main>
            <div id="side-nav">
                <div id="sover-eget-vaerelse"  class="selector" onclick="selectGroup('Eget')">
                    <p id="eget-vaerelse-number" class="large-number">0</p>
                    <p class="selector-text">Eget værelse</p>
                </div>
                <div id="sover-andet-varelse" class="selector" onclick="selectGroup('Andet')">
                    <p id="andet-vaerelse-number" class="large-number">0</p>
                    <p class="selector-text">Andet værelse</p>
                </div>
                <div id="ikke-valgt" class="selector" onclick="selectGroup('Ikke-Valgt')">
                    <p id="ikke-valgt-number" class="large-number">0</p>
                    <p class="selector-text">Har ikke valgt</p>
                </div>
            </div>
            <div id="container" class="full-container">

            </div>
        </main>
    </body>
</html>
